<% include ../theme/header.ejs %>
<% if( messages.length  > 0 ){ %>
    <p> <%= messages.msg %> </p>
    <% } %>
   
   
   <div class="maincontainer">
     <section id="product">
       <div class="container">
        <!--  breadcrumb --> 
        <ul class="breadcrumb">
            <li>
                <a href="#">Home</a>
                <span class="divider">/</span>
            </li>
            <li class="active"> Shopping Cart</li>
        </ul>       
      <center>   <h1 class="heading1"><span class="maintext"> </span><span class="subtext">Kết quả tìm kiếm </span></h1></center>
         <!-- Cart-->
        <% if(searchs.length > 0 ){ %>
        <div class="cart-info">
            <table class="table table-striped table-bordered">
                <tr>
                    <th class="image">Image</th>
                    <th class="name"> Name</th>
                    <th class="name">Size</th>
                    <th class="total">Action</th>
                    <th class="name">Type</th>
                    <th class="price">Price</th>
               </tr>
              <% var i = 0;
                searchs.forEach(function(search){ %>
                <td class="image"><img title="product" alt="product" src="/uploads/<%= search.img[0]%>" height="50" width="50"></a></td>
                <td  class="name"><%= search.name %></td>
                <td class="name"><%= search.title%> </td>
                <td class="total"> <a href="/product/<%= search._id %>/chitiet">Chi tiết </a>
                <td class="name"><%= search.type%> </td>
                <td id =  "<%= i %>"></td>
               <script type="text/javascript">
                    $(function(){
        
                        'use strict';
        
                        function formatMoney(amount, decimalCount = 2, decimal = ".", thousands = ",") {
                                try {
                                    decimalCount = Math.abs(decimalCount);
                                    decimalCount = isNaN(decimalCount) ? 2 : decimalCount;
        
                                    const negativeSign = amount < 0 ? "-" : "";
        
                                    let i = parseInt(amount = Math.abs(Number(amount) || 0).toFixed(decimalCount)).toString();
                                    let j = (i.length > 3) ? i.length % 3 : 0;
        
                                    return negativeSign + (j ? i.substr(0, j) + thousands : '') + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + thousands);
                                } catch (e) {
                                    console.log(e)   }};
                    $("#<%= i %>").append(formatMoney(<%= search.price%> ))
                        
                    }) 
        
                    </script>
                    </td>
                </tr> 
                <% i = i +1; %>
   
             <% }) %>
           
           </table>
       </div>
       <% } %>
     </section>
   </div>
    <div class= "container">
         <div class="row text-center">
            <% products.forEach(function(product){ %>
             <div class="col-lg-3 col-md-6 mb-4">
             <div class="card">
             
               <img id = "img" class="card-img-top" src="/uploads/<%= product.img[0] %>" alt="<%= product.name %>">
               <div class="card-body">
                 <h4 class="card-title"><%= product.name %></h4>
                 <p class="card-text"><%= product.title %></p>
               </div>
               <div class="card-footer">
                 <a href="/product/<%= product._id %>/chitiet" class="btn btn-primary">Xem chi tiết!</a>
               </div>
             </div>
           </div>
          <% })%>    
   
         </div>
   
   </div>
   <% include ../theme/footer.ejs %> 